stream
    |from()
        .measurement('cpu')
    |where(lambda: "cpu" == 'cpu-total')
    |groupBy(*)
    |eval(lambda: 100.0 - "usage_idle")
        .as('total_usage')
        .keep()
    |influxDBOut()
        .database('mydb')
        .create()
        .tag('source', 'kapacitor')
